# On-Chain Data Encryption

> Using _ChaCha20-Poly1305_ to encrypt data on-chain

## Use Case Summary

**On Chain Data Encryption** is a project that aims to provide a solution to the problem of data encryption on the blockchain. The project uses the _ChaCha20-Poly1305_ algorithm to encrypt data on-chain, allowing users to encrypt and decrypt data on-chain. Such a solution can be used in various scenarios, such as the encryption of private keys, passwords, and other sensitive data on the go in a decentralized manner on the smart contracts themself.

**With On-Chain Data Encryption, you can enable following features for your dApp:**

-   **Encryption of sensitive data:** Users can encrypt sensitive data such as private keys, passwords, and other sensitive data on the go in a decentralized manner on the smart contracts themself.
-   **Native Speed:** The _ChaCha20-Poly1305_ algorithm is implemented in native assembly, which is faster than any other on-chain alternative. This eliminates the need for off-chain encryption and decryption in most of the cases.
-   **Easy to use:** The project provides a simple interface for encryption and decryption of data on-chain, making it easy to use for developers. This provided 2 points of contact for developers to use the project in their dApps.
    -   Deploy Encryption Contract: Developers can call the methods of this contract to encrypt and decrypt data on-chain.
    -   Use Encryption Aspect: Developers can use the encryption aspect to encrypt and decrypt data on-chain.

## Team Members and Roles

Team Member 1: [Suryansh Chauhan](https://twitter.com/SuriPuri23)  
Team Member 2: [Rudransh Shinghal](https://twitter.com/rudransh190204)

## Problem Addressed

The idea of **On-Chain Data Encryption** aims to address the challenge of ensuring data security and confidentiality on the blockchain. As data on the blockchain is publicly accessible, there is a need to prevent unauthorized access to sensitive information. The project proposes the use of the _ChaCha20-Poly1305_ algorithm to encrypt data on-chain, enabling users to encrypt and decrypt data in a decentralized manner. This solution is essential for safeguarding private keys, passwords, and other sensitive data stored and utilized within smart contracts.

The need for on-chain data encryption arises due to the inherent security risks associated with off-chain encryption. Off-chain encryption requires the management of keys outside the blockchain, which can be vulnerable to compromise.

For example, when a healthcare provider needs to access a patient's record, they can do so by decrypting the data on-chain, ensuring the confidentiality and security of the patient's information.

## Project Design

### System Overview

#### 1. Project Overview

![Project Overview](docs/project_overview.png)

<!-- Additional info:

-   `Specific contract` is a contract address. For example, if it’s a DEX contract address, it means that the session key is only limited to calling an Artex contract.

-   `Specific methods` is a list of method signature of `Specific contract`. For example, if it’s `[0x0000CAFE, 0xCAFE0000,]` , it means that the session key is only limited to this two method. -->

#### 2. Flowchart

![Flowchart](docs/flowchart.png)

<!-- Additional info :

-   The `from` is still the address of EoA.

-   The signature `v,r,s` is generated by private key of sKey. -->

#### 3. Execution Sequence

![Execution Sequence](docs/execution_sequence.png)

<!-- Additional info

-   The transaction may be signed by the EoA privaten point needs to be verified by the EoA public key again if the Aspect returns key, so the joi false. -->

#### 4. Contract Design

![Contract Design](docs/contract_design.png)

<!-- Additional info

-   Smart contract doesn’t know which keys sign the tx.

-   When the smart contract accesses `msg.sender` , the value is `from` in the transaction. -->

### Implementation

Session-key Aspect project contains three components:

# TBD

-   **Client**, `sessioin-key-aspect.js`, a client for the dApp front end to use session key.
-   **Aspect**, wasm bytecode deployed on Artela
-   **Explorer,** extend Artela explorer to show Aspect info

![截屏2023-11-09 16.16.17.png](https://github.com/QiyuanMa/session-key-aspect-example/blob/main/img/2023-11-09-16.16.17.png)

#### Why we chose _ChaCha20-Poly1305_?

_ChaCha20-Poly1305_ is a symmetric encryption algorithm that is used to encrypt and decrypt data. It is a stream cipher that uses a 256-bit key and a 96-bit nonce. The ChaCha20-Poly1305 algorithm is a fast and secure encryption algorithm that is used in many applications, including TLS and SSH.

The decision to use the _ChaCha20_ encryption algorithm for the "On-Chain Data Encryption" project is based on several compelling reasons:

-   Performance: _ChaCha20-Poly1305_ is known for its exceptional performance, especially on mobile devices. It is approximately three times faster than AES-128-GCM on such devices, leading to lower gas fees when computing on-chain. Additionally, the _ChaCha20-Poly1305_ algorithm is implemented in native assembly, which is faster than any other on-chain alternative.

-   Security: The _ChaCha20-Poly1305_ construction is proven to be secure in the standard model. It offers similar levels of security to AES and is less prone to attacks, making it a robust choice for on-chain data encryption.

## Value to the Artela Ecosystem

The "On Chain Data Encryption" project provides significant value to the Artela ecosystem in several ways:

-   **Enhanced Security**: The project's on-chain data encryption solution enhances the security of the Artela blockchain network by encrypting sensitive data directly on the blockchain.
-   **Improved Functionality**: The project's solution enables developers to build more feature-rich dApps on the Artela network. By providing a secure and decentralized way to encrypt data on-chain, developers can create more sophisticated applications that require secure data storage and management.
-   **Integration**: The project's solution can be easily integrated into existing dApps on the Artela network, allowing developers to add encryption functionality to their applications without having to rewrite their code, adjusting for off-chain mechanisms.
-   **Potential for Widespread Adoption**: The project's use of the widely supported ChaCha20-Poly1305 algorithm for on-chain data encryption has the potential for widespread adoption, attracting more developers and users to the Artela ecosystem.

## How to Use

### Project Intro

# TBD

-   Folder [aspect](https://github.com/QiyuanMa/session-key-aspect-example/blob/main/aspect/README.md) implements the session key Aspect;
-   Folder [client](https://github.com/QiyuanMa/session-key-aspect-example/blob/main/js_client/session_key_aspect_client/README.md) implements the session key Aspect javascript client.

### Integration

-   Bind session key Aspect to you contract by this [guide](https://github.com/QiyuanMa/session-key-aspect-example/blob/main/aspect/README.md)
-   Integrate js client to you font-end dApp by this [guide](https://github.com/QiyuanMa/session-key-aspect-example/blob/main/js_client/session_key_aspect_client/README.md)

